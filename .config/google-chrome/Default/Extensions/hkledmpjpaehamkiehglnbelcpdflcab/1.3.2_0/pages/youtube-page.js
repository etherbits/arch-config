(()=>{"use strict";document.addEventListener("asbplayer-get-synced-data",(async()=>{const e={error:"",basename:"",subtitles:[]};try{const t=await fetch(window.location.href).then((e=>{if(!e.ok)throw new Error(`YT Context Retrieval failed with Status ${e.status}/${e.statusText}...`);return e.text()})).then((e=>(new window.DOMParser).parseFromString(e,"text/html"))).then((e=>{const t=e.body.querySelectorAll("script");for(let e=0;e<t.length;++e){const n=t[e];if(n.textContent?.includes("ytInitialPlayerResponse")){const e=new Function(`${n.textContent}; return ytInitialPlayerResponse;`)();if(e)return e}}}));if(!t)throw new Error("YT Player Context not found...");e.basename=t.videoDetails?.title||document.title,e.subtitles=(t?.captions?.playerCaptionsTracklistRenderer?.captionTracks||[]).map((e=>({label:`${e.languageCode} - ${e.name?.simpleText??e.name?.runs?.[0]?.text}`,language:e.languageCode.toLowerCase(),url:e.baseUrl,extension:"ytxml"})))}catch(t){t instanceof Error?e.error=t.message:e.error=String(t)}finally{document.dispatchEvent(new CustomEvent("asbplayer-synced-data",{detail:e}))}}),!1)})();